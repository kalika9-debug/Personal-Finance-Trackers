<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Smart Personal Finance Dashboard</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels"></script>
<style>
  body {
    font-family: "Poppins", sans-serif;
    background: linear-gradient(135deg, #f8f5ff, #ebe3ff);
    color: #333;
    margin: 0;
    text-align: center;
  }
  header {
    background: #4b0082;
    color: #fff;
    padding: 25px;
    font-size: 1.6rem;
    letter-spacing: 0.5px;
    box-shadow: 0 4px 10px rgba(0,0,0,0.1);
  }
  .container {
    margin: 40px auto;
    background: #fff;
    border-radius: 20px;
    padding: 40px;
    max-width: 900px;
    box-shadow: 0 6px 20px rgba(75,0,130,0.15);
  }
  input, button {
    padding: 12px;
    border-radius: 10px;
    border: 1px solid #ccc;
    font-size: 1rem;
    width: 80%;
    max-width: 400px;
    margin-top: 10px;
  }
  button {
    background: linear-gradient(90deg, #6a0dad, #4b0082);
    color: white;
    border: none;
    cursor: pointer;
    font-weight: 600;
    transition: 0.3s;
  }
  button:hover { transform: scale(1.05); }
  .dropdown { position: relative; width: 80%; max-width: 400px; margin: 0 auto; }
  .dropdown-list {
    position: absolute; top: 45px; left: 0; right: 0; background: #fff;
    border: 1px solid #ccc; border-radius: 10px; z-index: 10;
    max-height: 150px; overflow-y: auto; display: none;
    box-shadow: 0 4px 8px rgba(0,0,0,0.1);
  }
  .dropdown-list div { padding: 10px; cursor: pointer; }
  .dropdown-list div:hover { background: #f0ebff; }
  canvas { margin: 25px auto; display: block; }
  .summary, .insight-box {
    background: #faf6ff; border-radius: 12px; padding: 15px; margin-top: 15px;
    text-align: left; box-shadow: 0 0 8px rgba(106,13,173,0.1);
  }
  .insight-box { background: #f0ebff; border-left: 5px solid #6a0dad; }
  h2 { color: #4b0082; font-weight: 600; }
  .wide-chart-container {
    margin: 50px auto;
    max-width: 1000px;
    padding: 20px;
    background: #fff;
    border-radius: 20px;
    box-shadow: 0 8px 25px rgba(75,0,130,0.1);
  }
  #wideChart {
    width: 850px !important;
    height: 500px !important;
    display: block;
    margin: 0 auto;
  }
</style>
</head>
<body>

<header>üí∏ Smart Personal Finance Dashboard</header>

<!-- Front Page -->
<div class="container" id="inputSection">
  <h2>üîç Select or Search Your Name</h2>
  <p>Type your name to view your personalized financial insights.</p>

  <div class="dropdown">
    <input type="text" id="username" placeholder="Search user..." oninput="filterNames()" onclick="toggleDropdown(true)">
    <div id="dropdownList" class="dropdown-list"></div>
  </div>

  <input type="number" id="income" placeholder="Enter Monthly Income (‚Çπ)">
  <input type="number" id="goal" placeholder="Savings Goal (%)">
  <button onclick="showInsights()">Show My Insights</button>
</div>

<!-- Result Page -->
<div class="container" id="resultSection" style="display:none;">
  <h2 id="userTitle"></h2>
  <div id="summary" class="summary"></div>
  <canvas id="categoryChart"></canvas>
  <canvas id="trendChart"></canvas>
  <div id="insightBox" class="insight-box"></div>

  <!-- Compact Leaderboard -->
  <div class="wide-chart-container">
    <h2>üèÜ All Users Spending Comparison</h2>
    <canvas id="wideChart"></canvas>
    <div id="rankInsights" class="insight-box"></div>
  </div>

  <button onclick="restart()">‚Ü©Ô∏è Back</button>
</div>

<script>
// ===== Dataset =====
const dataset = [
  { date: "01-10-2025", category: "Food", amount: 150, user: "Aarav Sharma" },
  { date: "01-10-2025", category: "Transport", amount: 40, user: "Priya Patel" },
  { date: "02-10-2025", category: "Books", amount: 350, user: "Rohan Gupta" },
  { date: "03-10-2025", category: "Food", amount: 180, user: "Neha Reddy" },
  { date: "04-10-2025", category: "Entertainment", amount: 200, user: "Vihaan Singh" },
  { date: "05-10-2025", category: "Food", amount: 120, user: "Ananya Joshi" },
  { date: "06-10-2025", category: "Groceries", amount: 400, user: "Kavya Nair" },
  { date: "07-10-2025", category: "Transport", amount: 50, user: "Ishaan Kumar" },
  { date: "08-10-2025", category: "Food", amount: 140, user: "Aditi Verma" },
  { date: "09-10-2025", category: "Personal Care", amount: 180, user: "Arjun Mehta" },
  { date: "10-10-2025", category: "Food", amount: 110, user: "Saanvi Desai" },
  { date: "11-10-2025", category: "Entertainment", amount: 150, user: "Riya Kapoor" },
  { date: "12-10-2025", category: "Food", amount: 160, user: "Aryan Malhotra" },
  { date: "13-10-2025", category: "Books", amount: 250, user: "Diya Choudhury" },
  { date: "14-10-2025", category: "Transport", amount: 50, user: "Kartik Iyer" },
  { date: "15-10-2025", category: "Food", amount: 130, user: "Myra Bansal" },
  { date: "16-10-2025", category: "Groceries", amount: 350, user: "Shreya Rao" },
  { date: "17-10-2025", category: "Personal Care", amount: 200, user: "Virat Saxena" },
  { date: "18-10-2025", category: "Food", amount: 110, user: "Zara Khan" },
  { date: "19-10-2025", category: "Transport", amount: 60, user: "Yashvi Agarwal" }
];

// ===== Dropdown =====
const uniqueUsers = [...new Set(dataset.map(d => d.user))];
const dropdownList = document.getElementById("dropdownList");

function populateDropdown() {
  dropdownList.innerHTML = "";
  uniqueUsers.forEach(name => {
    const div = document.createElement("div");
    div.textContent = name;
    div.onclick = () => selectName(name);
    dropdownList.appendChild(div);
  });
}
function toggleDropdown(show) { dropdownList.style.display = show ? "block" : "none"; }
function filterNames() {
  const input = document.getElementById("username").value.toLowerCase();
  dropdownList.innerHTML = "";
  const filtered = uniqueUsers.filter(n => n.toLowerCase().includes(input));
  filtered.forEach(name => {
    const div = document.createElement("div");
    div.textContent = name;
    div.onclick = () => selectName(name);
    dropdownList.appendChild(div);
  });
  toggleDropdown(filtered.length > 0);
}
function selectName(name) {
  document.getElementById("username").value = name;
  toggleDropdown(false);
}

// ===== Main Function =====
function showInsights() {
  const name = document.getElementById("username").value.trim();
  const income = parseFloat(document.getElementById("income").value);
  const goal = parseFloat(document.getElementById("goal").value);
  if (!name || !income || !goal) return alert("Please fill all fields!");
  const userData = dataset.filter(d => d.user.toLowerCase() === name.toLowerCase());
  if (userData.length === 0) return alert("No records found for this name!");

  document.getElementById("inputSection").style.display = "none";
  document.getElementById("resultSection").style.display = "block";

  const totalSpent = userData.reduce((sum, d) => sum + d.amount, 0);
  const byCategory = {};
  userData.forEach(d => byCategory[d.category] = (byCategory[d.category] || 0) + d.amount);

  const savings = (income - totalSpent).toFixed(2);
  const savingsPercent = ((savings / income) * 100).toFixed(2);
  const goalStatus = savingsPercent >= goal ? "‚úÖ Goal Achieved" : "‚ö†Ô∏è Below Target";

  document.getElementById("userTitle").innerText = `üìä ${name}'s Financial Insights`;
  document.getElementById("summary").innerHTML = `
    <p><b>Total Income:</b> ‚Çπ${income}</p>
    <p><b>Total Expenses:</b> ‚Çπ${totalSpent}</p>
    <p><b>Total Savings:</b> ‚Çπ${savings} (${savingsPercent}%)</p>
    <p><b>Status:</b> ${goalStatus}</p>
  `;

  // Category Pie Chart
  new Chart(document.getElementById("categoryChart"), {
    type: "pie",
    data: {
      labels: Object.keys(byCategory),
      datasets: [{ data: Object.values(byCategory), backgroundColor: ["#4b0082","#6a0dad","#9c27b0","#ba68c8","#ce93d8","#ab47bc"] }]
    },
    options: { plugins: { legend: { position: "bottom" } } }
  });

  // Spending Trend
  const dates = userData.map(d => d.date);
  const amounts = userData.map(d => d.amount);
  new Chart(document.getElementById("trendChart"), {
    type: "line",
    data: { labels: dates, datasets: [{ label: "Spending Over Time", data: amounts, borderColor: "#6a0dad", fill: false, tension: 0.3 }] },
    options: { scales: { y: { beginAtZero: true } } }
  });

  // Insights
  const top3 = Object.entries(byCategory).sort((a,b)=>b[1]-a[1]).slice(0,3);
  let insight = `<b>Top 3 Spending Categories:</b><br>`;
  top3.forEach(([cat, amt], i) => insight += `${i+1}. ${cat} - ‚Çπ${amt}<br>`);
  if (savingsPercent < 10) insight += "<hr>‚ö†Ô∏è You‚Äôre overspending ‚Äî save more by cutting luxuries.";
  else if (savingsPercent < 25) insight += "<hr>üí° Balanced spender ‚Äî small tweaks can boost your savings.";
  else insight += "<hr>üåü Excellent management ‚Äî your savings reflect discipline.";
  document.getElementById("insightBox").innerHTML = insight;

  // Compact Leaderboard
  const totalsByUser = {};
  dataset.forEach(d => totalsByUser[d.user] = (totalsByUser[d.user] || 0) + d.amount);
  const leaderboard = Object.entries(totalsByUser).map(([user, amt]) => ({ user, amt }));
  leaderboard.sort((a,b) => b.amt - a.amt);

  new Chart(document.getElementById("wideChart"), {
    type: "bar",
    data: {
      labels: leaderboard.map((d, i) => `${i+1}. ${d.user}`),
      datasets: [{
        label: "Total Spending (‚Çπ)",
        data: leaderboard.map(d => d.amt),
        backgroundColor: leaderboard.map(u => u.user === name ? "#4b0082" : "#a770ef"),
        borderRadius: 6
      }]
    },
    options: {
      indexAxis: "y",
      plugins: {
        title: { display: true, text: "All Users ‚Äî Spending Distribution", color: "#4b0082", font: { size: 18, weight: "bold" } },
        legend: { display: false },
        datalabels: { color: "#111", anchor: "end", align: "right", font: { weight: "bold", size: 12 }, formatter: val => "‚Çπ" + val }
      },
      scales: {
        x: { ticks: { color: "#333", font: { size: 12 } }, title: { display: true, text: "Spending Amount (‚Çπ)", color: "#4b0082" } },
        y: { ticks: { color: "#333", font: { size: 12 } } }
      },
      animation: { duration: 1000, easing: "easeOutCubic" }
    },
    plugins: [ChartDataLabels]
  });

  // Ranking & Comparative Insight
  const rank = leaderboard.findIndex(u => u.user === name) + 1;
  let rankInsight = `<b>${name}</b>, you rank <b>#${rank}</b> among ${leaderboard.length} users in total spending.<br>`;
  if (rank === 1) rankInsight += "ü•á You‚Äôre the top spender ‚Äî time to tighten up that budget!";
  else if (rank <= 3) rankInsight += "ü•à You‚Äôre in the top 3 ‚Äî maybe rethink recurring luxuries.";
  else if (rank <= leaderboard.length/2) rankInsight += "üòé You‚Äôre in the middle zone ‚Äî maintain the balance!";
  else rankInsight += "üí∞ Great! You‚Äôre among the most frugal and focused savers.";
  document.getElementById("rankInsights").innerHTML = rankInsight;
}

function restart() {
  document.getElementById("username").value = "";
  document.getElementById("income").value = "";
  document.getElementById("goal").value = "";
  document.getElementById("resultSection").style.display = "none";
  document.getElementById("inputSection").style.display = "block";
  populateDropdown();
}

populateDropdown();
</script>
</body>
</html>
